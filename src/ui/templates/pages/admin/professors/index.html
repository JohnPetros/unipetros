{% extends "layouts/dashboard/index.html" %}

{% from 'components/modal.html' import modal %}
{% from 'components/csv_button.html' import csv_button %}
{% from 'components/search.html' import search %}
{% from 'components/dropdown.html' import dropdown %}
{% from 'components/checkbox.html' import checkbox %}
{% from 'components/pagination/index.html' import pagination %}

{% block dashboard_content %}

<div class="flex items-center gap-3">
  {% call modal(
  id="professor-modal", title='Adicionar professor',
  is_default_open=professor_form.errors | length
  )
  %}
  {% include 'components/professor_modal.html' %}
  {% endcall %}

  {{
  csv_button(
  id="professors_csv",
  action='import',
  url=url_for("admin_views.create_professors_by_csv_view"),
  target="#professors-table"
  )
  }}
</div>
<form
  hx-get="{{ url_for('admin_views.get_filtered_professors_view') }}"
  hx-target="#professors-table"
  hx-trigger="trigger, keyup from:#search changed delay:500ms, search from:#search, change from:input[type='checkbox'], change from:#pagination-input"
  hx-swap="innerHTML"
  class="flex items-end gap-3 w-full mt-6">
  {{
  search(
  label='Pesquisar professor por nome ou e-mail',
  placeholder='Girafalles da NÃ´brega',
  value=search_value
  )
  }}

  {% call dropdown(title="Selecionar disciplina") %}
  <ul class="space-y-3" data-checklist-group="container">
    {% for subject_checkbox in subjects_checkbox_group %}
    <li>
      {{
      checkbox(
      id=subject_checkbox[1],
      name="subjects_ids[]",
      label=subject_checkbox[1],
      value=subject_checkbox[0],
      attributes='data-checklist-group=checkbox'
      )
      }}
    </li>

    {% endfor %}
  </ul>
  {% endcall %}

  <input
    data-pagination="input"
    id="pagination-input"
    type="text"
    name="page"
    hidden>

</form>

<div class="relative mt-6">
  <div
    id="professors-table">
    {% include 'pages/admin/professors/table/index.html' %}
  </div>

  <div class="mt-6 fixed bottom-2">
    {{ pagination(current_page_number=1, pages_count=4) }}
  </div>
</div>

<script
  src="{{ url_for('static', filename='scripts/checkbox_group.js') }}"></script>

{% endblock dashboard_content %}